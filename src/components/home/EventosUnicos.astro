---
import ServiceCard from '../ui/ServiceCard.astro';
import imgBodasUnique from '../../assets/images/fotografia.webp';
import imgQuinceUnique from '../../assets/images/fiesta-quince.webp';
import imgEmpresarialesUnique from '../../assets/images/0j8a0641.webp';
import { SITE_CONFIG, getAbsoluteUrl } from '../../config/site';
import { useTranslations } from '../../i18n/utils';

interface Props {
  lang?: 'es' | 'en';
}

const { lang = 'es' } = Astro.props;
const t = useTranslations(lang);

// Service cards data
const services = [
    {
        title: t('services.weddings'),
        image: imgBodasUnique,
        url: getAbsoluteUrl(SITE_CONFIG.routes.weddings)
    },
    {
        title: t('services.quinceañeras'),
        image: imgQuinceUnique,
        url: getAbsoluteUrl(SITE_CONFIG.routes.quinceañeras)
    },
    {
        title: t('services.corporate'),
        image: imgEmpresarialesUnique,
        url: getAbsoluteUrl(SITE_CONFIG.routes.corporate)
    }
];
---

<section class="bg-brand-cream py-8 md:py-16">
    <div class="max-w-7xl mx-auto px-4 md:px-16">
        <h2 class="text-4xl md:text-7xl text-center mb-12">
            <span class="text-brand-green">{t('home.uniqueEvents.title1')}</span>
            <span class="text-brand-darkGray">{t('home.uniqueEvents.title2')}</span>
        </h2>

        <div class="relative w-full group">

            <button
                class="swiper-prev-events absolute left-0 md:-left-14 top-[40%] -translate-y-1/2 z-50 w-12 h-12 bg-white rounded-full shadow-xl flex items-center justify-center hover:bg-gray-50 transition-all border border-gray-100 text-gray-800 cursor-pointer"
                aria-label={t('common.ariaLabels.prevSlide')}
            >
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"/></svg>
            </button>

            <button
                class="swiper-next-events absolute right-0 md:-right-14 top-[40%] -translate-y-1/2 z-50 w-12 h-12 bg-white rounded-full shadow-xl flex items-center justify-center hover:bg-gray-50 transition-all border border-gray-100 text-gray-800 cursor-pointer"
                aria-label={t('common.ariaLabels.nextSlide')}
            >
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m9 18 6-6-6-6"/></svg>
            </button>

            <div class="swiper mySwiperEvents !p-6">
                <div class="swiper-wrapper">
                   {services.map((service, index) => (
                       <ServiceCard
                           title={service.title}
                           image={service.image}
                           url={service.url}
                           loading={index === 0 ? "eager" : "lazy"}
                           fetchpriority={index === 0 ? "high" : undefined}
                       />
                   ))}
                </div>
            </div>
        </div>

    </div>

    <nav class="w-full border-t border-b border-gray-300 mt-6" aria-label={t('common.navigation.services')}>
        <div class="max-w-7xl mx-auto grid grid-cols-3 text-center text-sm md:text-base text-gray-500 font-alice">
            <a href={getAbsoluteUrl(SITE_CONFIG.routes.services)} class="py-1 hover:text-brand-green cursor-pointer transition-colors">
                {t('services.social')}
            </a>
            <a href={getAbsoluteUrl(SITE_CONFIG.routes.corporate)} class="py-1 hover:text-brand-green cursor-pointer transition-colors">
                {t('services.corporate')}
            </a>
            <a href={getAbsoluteUrl(SITE_CONFIG.routes.tourism)} class="py-1 hover:text-brand-green cursor-pointer transition-colors">
                {t('services.institutional')}
            </a>
        </div>
    </nav>
</section>

<style>
    /* Swiper configuration */
    .swiper {
        width: 100%;
        height: auto;
    }

    .swiper-slide {
        height: auto;
        user-select: none;
        will-change: transform;
    }

    /* Navigation buttons */
    .swiper-prev-events, .swiper-next-events {
        display: flex !important;
        opacity: 1 !important;
        visibility: visible !important;
        width: 48px;
        height: 48px;
    }

    /* Prevent image from blocking touch/mouse events */
    img {
        pointer-events: none;
    }
</style>

<script>
    import Swiper from 'swiper';
    import { Navigation } from 'swiper/modules';
    import 'swiper/css';
    import 'swiper/css/navigation';

    const initEventsSwiper = () => {
        requestAnimationFrame(() => {
            new Swiper(".mySwiperEvents", {
                modules: [Navigation],
                slidesPerView: 1,
                spaceBetween: 50,
                loop: true,
                simulateTouch: true,
                grabCursor: true,
                navigation: {
                    nextEl: ".swiper-next-events",
                    prevEl: ".swiper-prev-events",
                },
                observer: false,
                observeParents: false,
                breakpoints: {
                    640: { slidesPerView: 1.5, spaceBetween: 30 },
                    768: { slidesPerView: 2, spaceBetween: 40 },
                    1024: { slidesPerView: 3, spaceBetween: 50 }
                },
            });
        });
    };

    initEventsSwiper();
    document.addEventListener('astro:page-load', initEventsSwiper);
</script>
